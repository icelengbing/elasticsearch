[[indices-put-mapping]]
== 设置映射

PUT 映射 API 允许您添加字段到现有索引或更改现有字段的搜索设置。

[source,js]
--------------------------------------------------
PUT twitter <1>
{}

PUT twitter/_mapping/_doc <2>
{
  "properties": {
    "email": {
      "type": "keyword"
    }
  }
}
--------------------------------------------------
// CONSOLE
<1> 不带任何类型映射 <<indices-create-index,创建一个索引>> `twitter`。
<2> 使用 PUT 映射 API 将名为 `email` 的新字段添加到 `_doc` 映射类型。

有关如何定义类型映射的更多信息，请参阅 <<mapping,映射>> 章节。

[float]
=== 多索引

PUT 映射 API 可以将单个请求应用于多个索引。例如，我们可以同时更新 `twitter-1` 和 `twitter-2` 索引的映射：

[source,js]
--------------------------------------------------
# Create the two indices
PUT twitter-1
PUT twitter-2

# Update both mappings
PUT /twitter-1,twitter-2/_mapping/_doc <1>
{
  "properties": {
    "user_name": {
      "type": "text"
    }
  }
}
--------------------------------------------------
// CONSOLE
<1> 请注意，指定的索引（`twitter-1，twitter-2`）需遵循 <<multi-index,多索引名称>> 和通配符格式。

NOTE: 使用 <<indices-put-mapping,PUT mapping>> API 更新 `_default_` 映射时，新映射不会与现有映射合并。相反，新的 `_default_` 映射会取代现有映射。

[[updating-field-mappings]]
[float]
=== 更新字段映射

通常，无法更新现有字段的映射。不过有一些例外。例如：

* 新的 <<properties>> 能够被添加到 <<object>> 字段中。
* 新的 <<multi-fields,多重字段>> 能够被添加到现有字段中。
* 参数 <<ignore-above>> 可以被更新。

例如：

[source,js]
-----------------------------------
PUT my_index <1>
{
  "mappings": {
    "_doc": {
      "properties": {
        "name": {
          "properties": {
            "first": {
              "type": "text"
            }
          }
        },
        "user_id": {
          "type": "keyword"
        }
      }
    }
  }
}

PUT my_index/_mapping/_doc
{
  "properties": {
    "name": {
      "properties": {
        "last": { <2>
          "type": "text"
        }
      }
    },
    "user_id": {
      "type": "keyword",
      "ignore_above": 100 <3>
    }
  }
}
-----------------------------------
// CONSOLE
<1> 创建一个索引，包含 `name` 和 `user_id` 字段，其中 `name` <<object>> 字段含有属性 `first` 字段。
<2> 为对象字段 `name` 添加 `last` 字段.
<3> 更新 `ignore_above` 设置的默认值。

每个 <<mapping-params,映射参数>> 指定是否可以在现有字段上更新其设置。
